# ============================================================
# RAG MCP Example Environment Configuration
# ------------------------------------------------------------
# Copy this file to `.env` (same directory as your project) and
# fill in the required values. Do NOT commit your real secrets.
#
# Precedence (highest to lowest):
#   1. CLI flags (e.g. `rag-mcp serve --azure-endpoint ...`)
#   2. Real environment variables exported in the shell
#   3. .env file (this file once renamed to .env)
#   4. Built-in defaults in the code
#
# Required (must be set for the server to start):
#   - AZURE_OPENAI_API_KEY (or OPENAI_API_KEY as a fallback)
#   - AZURE_ENDPOINT (or AZURE_OPENAI_ENDPOINT)
#
# Optional tuning & advanced variables are included below.
# ============================================================

# -------------------------
# Azure OpenAI Credentials
# -------------------------

# Primary Azure OpenAI API key (KEEP SECRET).
AZURE_OPENAI_API_KEY=replace_with_your_azure_key

# Optional fallback name (some setups export OPENAI_API_KEY instead).
# If both are set, AZURE_OPENAI_API_KEY wins.
# OPENAI_API_KEY=replace_with_your_azure_key

# Base Azure OpenAI endpoint WITHOUT a trailing slash.
# Example: https://my-azure-resource.openai.azure.com
AZURE_ENDPOINT=https://your-resource-name.openai.azure.com

# Legacy / alternate variable name also checked by the code.
# AZURE_OPENAI_ENDPOINT=https://your-resource-name.openai.azure.com

# API version to use (must match deployments available in your Azure resource).
AZURE_API_VERSION=2024-12-01-preview


# -------------------------
# Deployment Names
# -------------------------
# These must match the deployment names you configured in the Azure OpenAI portal.

# Embedding model deployment (used for vector representations).
AZURE_EMBEDDING_DEPLOYMENT=text-embedding-3-large

# Chat / reasoning model deployment (used for query rewriting, chunk planning, Q&A).
AZURE_CHAT_DEPLOYMENT=gpt-5


# -------------------------
# Persistence / Storage
# -------------------------
# Root directory where indices, metadata, and caches are stored.
# This will create (if absent):
#   <RAG_MCP_HOME>/
#     meta/ (global caches, embedding dimension cache)
#     indices/<index_name>/
RAG_MCP_HOME=~/.rag_mcp

# NOTE: A variable named PERSIST_DIRECTORY is NOT used by this project.
# If you had one from other tooling, remove or ignore it.


# -------------------------
# Tokenization / Context
# -------------------------
# Tokenizer model name passed to tiktoken. The default in code is 'gpt-5-'
# (with trailing hyphen). If unsupported, it falls back to cl100k_base internally.
TOKENIZER_MODEL=gpt-5-

# Default maximum number of retrieval context tokens to pack for answering
# (can be overridden per tool call). Very large by design for modern long-context models.
DEFAULT_CONTEXT_TOKENS=272000


# -------------------------
# Hybrid Retrieval Defaults
# -------------------------
# Alpha weighting for score fusion:
#   final = alpha * vector_score + (1 - alpha) * bm25_score
# Range: 0.0 (BM25 only) to 1.0 (vector only). Default = 0.5
DEFAULT_HYBRID_ALPHA=0.5


# -------------------------
# Networking / Timeouts
# -------------------------
# Per-request HTTP timeout (seconds) for Azure OpenAI calls.
REQUEST_TIMEOUT_SECONDS=60


# -------------------------
# Advanced / Internal (normally leave as is)
# -------------------------
# Override embedding dimension detection cache location by changing RAG_MCP_HOME only.
# The server auto-detects embedding dimension the first time and caches it.
# No direct env var needed for that behavior.

# Increase logging verbosity by passing CLI flag: --log-level debug
# Or run: uv run rag-mcp serve --log-level debug

# Set JSON logging (for structured aggregators) via CLI: --log-json

# -------------------------
# Example Invocation After Copying to .env
# -------------------------
# uv run rag-mcp serve
#   or with overrides:
# uv run rag-mcp serve \
#   --persistence-dir ~/.rag_mcp \
#   --azure-endpoint https://your-resource-name.openai.azure.com \
#   --azure-api-version 2024-12-01-preview \
#   --azure-embedding-deployment text-embedding-3-large \
#   --azure-chat-deployment gpt-5 \
#   --log-level info

# -------------------------
# Security Tips
# -------------------------
# 1. Never commit a real .env containing secrets.
# 2. Use a secret manager (pass/1Password/Keychain) if possible.
# 3. If sharing the project, keep only this example file under version control.
# 4. Rotate keys periodically and immediately if leaked.

# End of example.env
